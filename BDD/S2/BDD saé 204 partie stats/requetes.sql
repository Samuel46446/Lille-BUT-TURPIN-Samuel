-- Exercice 3
--Q1/Q2
SELECT n56, CONCAT(n57+n58+n59) AS calcul --utilisation d'un concat pour le calcul des néo bacheliers
FROM import
WHERE n56=(n57+n58+n59);

--Q3/Q4
SELECT n74, (CASE WHEN n49 = 0 THEN 0 ELSE Round(100*((CAST(n51 AS NUMERIC))/(n49+n50)), 1) END) AS calcul
FROM import;
--l'égalité ne marche pas pour la 1er ligne
--WHERE n74=Round(100*((CAST(n51 AS NUMERIC))/(n49+n50)), 1)OR  n74=Round(100*((CAST(n51 AS NUMERIC))/(n49+n50))+1, 1);

--Q5
SELECT n76, Round(CAST(CASE WHEN n49 = 0 THEN 0 ELSE Round(100*(CAST(n53 AS NUMERIC)/(n49+n50))) END AS NUMERIC),1) AS calcul
FROM import
WHERE CAST(n76 AS NUMERIC)=Round(CAST(CASE WHEN n49 = 0 THEN 0 ELSE Round(100*(CAST(n53 AS NUMERIC)/(n49+n50))) END AS NUMERIC),1);

--Q6
SELECT n76, Round(CAST(CASE WHEN n49 = 0 THEN 0 ELSE Round(100*(CAST(n53 AS NUMERIC)/(n49+n50))) END AS NUMERIC),1) AS calcul
FROM stats
WHERE CAST(n76 AS NUMERIC)=Round(CAST(CASE WHEN n49 = 0 THEN 0 ELSE Round(100*(CAST(n53 AS NUMERIC)/(n49+n50))) END AS NUMERIC),1);

--Q7
SELECT n81, Round(CAST(CASE WHEN n56 = 0 THEN 0 ELSE Round(((CAST(n55 AS NUMERIC)/CAST(n56 AS NUMERIC))*100)) END AS NUMERIC), 1) AS calcul
FROM import
WHERE CAST(n81 AS NUMERIC)=Round(CAST(CASE WHEN n56 = 0 THEN 0 ELSE Round(((CAST(n55 AS NUMERIC)/CAST(n56 AS NUMERIC))*100)) END AS NUMERIC), 1);

--Q8
SELECT n81, Round(CAST(CASE WHEN n56 = 0 THEN 0 ELSE Round(((CAST(n55 AS NUMERIC)/CAST(n56 AS NUMERIC))*100)) END AS NUMERIC), 1) AS calcul
FROM stats
WHERE CAST(n81 AS NUMERIC)=Round(CAST(CASE WHEN n56 = 0 THEN 0 ELSE Round(((CAST(n55 AS NUMERIC)/CAST(n56 AS NUMERIC))*100)) END AS NUMERIC), 1);